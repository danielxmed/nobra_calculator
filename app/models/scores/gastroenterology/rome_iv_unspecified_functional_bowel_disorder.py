"""
Rome IV Diagnostic Criteria for Unspecified Functional Bowel Disorder Models

Request and response models for Rome IV unspecified functional bowel disorder diagnostic assessment.

References (Vancouver style):
1. Lacy BE, Mearin F, Chang L, Chey WD, Lembo AJ, Simren M, Spiller R. Bowel disorders. 
   Gastroenterology. 2016 May;150(6):1393-1407.e5. doi: 10.1053/j.gastro.2016.02.031.
2. Rome Foundation. Rome IV Diagnostic Criteria for Functional Gastrointestinal 
   Disorders. 4th ed. Raleigh, NC: Rome Foundation; 2016.
3. Palsson OS, Whitehead WE, van Tilburg MA, Chang L, Chey W, Crowell MD, Keefer L, 
   Lembo AJ, Parkman HP, Rao SS, Sperber A, Spiegel B, Tack J, Vanner S, Walker LS, 
   Whorwell P, Yang M. Rome IV diagnostic questionnaires and tables for investigators 
   and clinicians. Gastroenterology. 2016 May;150(6):1481-1491. 
   doi: 10.1053/j.gastro.2016.02.014.

CLINICAL BACKGROUND:

The Rome IV Diagnostic Criteria for Unspecified Functional Bowel Disorder represents 
a catch-all category within the functional bowel disorders classification system. 
This diagnosis applies to patients who have clear functional bowel symptoms that 
do not meet the specific criteria for more defined disorders such as Irritable 
Bowel Syndrome (IBS), functional constipation, functional diarrhea, or functional 
abdominal bloating/distension.

DIAGNOSTIC FRAMEWORK:

The Rome IV criteria recognize that functional bowel disorders constitute a spectrum 
of gastrointestinal disorders rather than isolated entities. While characterized as 
distinct disorders based on diagnostic criteria, significant overlap exists between 
different functional conditions. The unspecified functional bowel disorder category 
acknowledges this complexity and provides a diagnostic option for patients whose 
symptoms don't fit neatly into specific categories.

ROME IV DIAGNOSTIC CRITERIA:

The diagnostic criterion for Unspecified Functional Bowel Disorder is deliberately 
broad yet specific in its exclusions:

PRIMARY CRITERION:
- Bowel symptoms not attributable to an organic etiology that do not meet criteria 
  for IBS, functional constipation, functional diarrhea, or functional abdominal 
  bloating/distension disorders

TEMPORAL REQUIREMENTS:
- Criterion fulfilled for the last 3 months with symptom onset at least 6 months 
  prior to diagnosis

CLINICAL CHARACTERISTICS:

Patient Presentation:
- Bowel symptoms that are clearly functional in nature
- Symptoms cause distress or impact quality of life
- Organic evaluation has been negative or appropriate
- Symptoms don't fit criteria for specific functional disorders
- May have mixed or atypical symptom patterns

Symptom Patterns:
- May include combinations of constipation and diarrhea
- Abdominal pain not meeting IBS criteria
- Bloating not meeting functional bloating criteria
- Altered bowel habits without clear pattern
- Symptoms may fluctuate or change over time

Psychosocial Factors:
- Often associated with stress or psychological factors
- May have comorbid anxiety or depression
- Social and occupational impact from symptoms
- Patient frustration from lack of specific diagnosis

DIFFERENTIAL DIAGNOSIS:

Specific Functional Bowel Disorders:

Irritable Bowel Syndrome (IBS):
- Requires recurrent abdominal pain associated with altered bowel habits
- Pain related to defecation, change in stool frequency, or stool form
- Clear criteria for IBS-C (constipation), IBS-D (diarrhea), or IBS-M (mixed)
- Abdominal pain is the predominant symptom

Functional Constipation:
- Requires specific criteria for difficult, infrequent, or incomplete defecation
- Bristol stool scale types 1-2 predominant
- Straining, incomplete evacuation, manual maneuvers
- Rarely meets criteria for IBS

Functional Diarrhea:
- Loose or watery stools (Bristol types 6-7) in >75% of bowel movements
- Absence of abdominal pain (distinguishes from IBS-D)
- No evidence of inflammatory, anatomic, or metabolic cause
- Symptoms present for required temporal criteria

Functional Abdominal Bloating/Distension:
- Predominant complaint of bloating or visible distension
- Not predominantly pain or altered bowel habits
- May have associated bowel symptoms but not meeting other criteria
- Significant impact on daily activities

Organic Bowel Disorders:

Inflammatory Bowel Disease:
- Crohn's disease or ulcerative colitis
- Inflammatory markers elevated
- Endoscopic and histologic evidence of inflammation
- May have extraintestinal manifestations

Celiac Disease:
- Positive serology (tissue transglutaminase, endomysial antibodies)
- Duodenal biopsy showing villous atrophy
- Symptoms improve with gluten-free diet
- Associated malabsorption and nutritional deficiencies

Microscopic Colitis:
- Chronic watery diarrhea in older adults
- Normal or near-normal colonoscopy
- Characteristic histologic findings on biopsy
- May be associated with medications

Colorectal Malignancy:
- Alarm symptoms: bleeding, weight loss, anemia
- Family history or genetic predisposition
- Age-appropriate screening abnormalities
- Progressive symptom course

ALARM SYMPTOMS REQUIRING EVALUATION:

Red Flag Symptoms:
- Gastrointestinal bleeding (melena, hematemesis, hematochezia)
- Unexplained iron deficiency anemia
- Unintentional weight loss (>10% body weight over 6 months)
- Palpable abdominal mass or lymphadenopathy
- Family history of colorectal cancer without appropriate screening
- Symptom onset after age 50 without cancer screening
- Sudden change in bowel habits

Additional Concerning Features:
- Nocturnal symptoms awakening patient from sleep
- Fever associated with bowel symptoms
- Progressive worsening of symptoms
- Failure to respond to appropriate therapy
- Presence of extraintestinal manifestations

DIAGNOSTIC WORKUP:

Initial Evaluation:

History and Physical Examination:
- Detailed symptom characterization with temporal patterns
- Assessment of functional impact on quality of life
- Review of prior evaluations and treatments attempted
- Family history of gastrointestinal and other relevant diseases
- Medication history including recent antibiotic use
- Dietary history and trigger identification

Laboratory Studies:
- Complete blood count with differential
- Comprehensive metabolic panel
- Inflammatory markers (ESR, CRP)
- Tissue transglutaminase antibodies (celiac screen)
- Stool studies if diarrhea predominant
- Additional studies based on specific symptoms

Additional Testing (if indicated):
- Colonoscopy if alarm symptoms or screening indicated
- Upper endoscopy if upper GI symptoms prominent
- Imaging studies (CT abdomen/pelvis) if structural concerns
- Breath testing for small intestinal bacterial overgrowth
- Anorectal manometry if defecation disorders suspected

MANAGEMENT APPROACH:

Treatment Principles:
- No standardized treatment protocol exists
- Management should be symptom-directed and individualized
- Combination of dietary, pharmacologic, and behavioral interventions
- Patient education about functional nature of condition
- Regular follow-up to monitor response and adjust therapy

Dietary Interventions:

General Dietary Modifications:
- Elimination of known dietary triggers
- Gradual introduction of fiber (if constipation component)
- Reduction of gas-producing foods (if bloating component)
- Small, frequent meals to reduce symptom severity

Specific Dietary Approaches:
- Low FODMAP diet trial (if IBS-like symptoms)
- Gluten-free diet trial (if celiac symptoms)
- Lactose restriction (if lactose intolerance suspected)
- Soluble fiber supplementation for bowel regulation

Pharmacologic Options:

Symptom-Directed Therapy:
- Antispasmodics for cramping and pain
- Loperamide for diarrhea-predominant symptoms
- Osmotic laxatives for constipation-predominant symptoms
- Simethicone for gas and bloating
- Probiotics for microbiome modulation

Advanced Therapies (if needed):
- Tricyclic antidepressants for pain and bowel regulation
- SSRIs for anxiety and bowel symptoms
- Rifaximin for suspected bacterial overgrowth
- Prescription therapies for specific symptom patterns

Behavioral and Psychological Interventions:

Stress Management:
- Cognitive-behavioral therapy for coping strategies
- Stress reduction techniques and relaxation training
- Mindfulness and meditation practices
- Regular exercise and physical activity

Patient Education:
- Explanation of functional disorder concept
- Reassurance about benign nature of condition
- Setting realistic expectations for improvement
- Importance of lifestyle modifications

PROGNOSIS AND FOLLOW-UP:

Expected Outcomes:
- Variable response to treatment depending on symptom pattern
- Many patients benefit from multimodal approach
- Symptoms may fluctuate over time with stress and life changes
- Overall prognosis is good with appropriate management

Monitoring and Reassessment:
- Regular follow-up to assess treatment response
- Monitoring for development of alarm symptoms
- Periodic reassessment of diagnosis as symptoms evolve
- Consideration of specialist referral for refractory cases

Long-term Considerations:
- Symptoms may evolve to meet criteria for specific disorders
- Importance of maintaining therapeutic relationship
- Avoiding excessive testing in absence of alarm symptoms
- Focus on quality of life and functional improvement

SPECIAL POPULATIONS:

Elderly Patients:
- Higher likelihood of organic pathology
- More frequent screening requirements
- Medication interactions and side effects
- Slower response to dietary interventions

Pediatric and Adolescent Patients:
- Growth and development considerations
- School and social impact assessment
- Family dynamics and support systems
- Age-appropriate educational materials

Patients with Comorbidities:
- Consideration of medication interactions
- Impact of systemic diseases on bowel function
- Coordination with other specialists
- Modified treatment approaches as needed

This comprehensive diagnostic tool provides a systematic approach to identifying 
patients with unspecified functional bowel disorder while ensuring appropriate 
exclusion of organic pathology and more specific functional disorders.
"""

from pydantic import BaseModel, Field
from typing import Literal


class RomeIvUnspecifiedFunctionalBowelDisorderRequest(BaseModel):
    """
    Request model for Rome IV Diagnostic Criteria for Unspecified Functional Bowel Disorder
    
    Rome IV criteria for unspecified functional bowel disorder require ALL of the following:
    
    INCLUSION CRITERIA:
    1. Bowel symptoms present for ≥3 months with symptom onset ≥6 months prior to diagnosis
    2. Bowel symptoms not attributable to an organic etiology
    
    EXCLUSION OF OTHER FUNCTIONAL DISORDERS:
    3. Does not meet Rome IV criteria for Irritable Bowel Syndrome (IBS)
    4. Does not meet Rome IV criteria for functional constipation
    5. Does not meet Rome IV criteria for functional diarrhea
    6. Does not meet Rome IV criteria for functional abdominal bloating/distension
    
    EXCLUSION OF ALARM SYMPTOMS:
    7. No gastrointestinal bleeding
    8. No unexplained iron deficiency anemia
    9. No unintentional weight loss
    10. No palpable abdominal mass or lymphadenopathy
    11. No family history of colon cancer without appropriate screening
    12. No symptom onset after age 50 without cancer screening
    13. No sudden change in bowel habits
    
    Clinical Context:
    This diagnosis serves as a "catch-all" for functional bowel symptoms that don't 
    fit into more specific categories. Patients may have mixed symptom patterns, 
    atypical presentations, or symptoms that fluctuate between different functional 
    disorder criteria. The diagnosis acknowledges that functional bowel disorders 
    represent a spectrum rather than isolated entities with significant overlap.
    
    Management Approach:
    - No standardized treatment protocol exists
    - Symptom-directed therapy using combination approaches
    - Dietary modifications based on predominant symptom pattern
    - Pharmacologic options targeting specific symptoms
    - Behavioral interventions and stress management
    - Patient education about functional nature of condition
    
    References (Vancouver style):
    1. Lacy BE, Mearin F, Chang L, Chey WD, Lembo AJ, Simren M, Spiller R. Bowel disorders. 
       Gastroenterology. 2016 May;150(6):1393-1407.e5. doi: 10.1053/j.gastro.2016.02.031.
    2. Rome Foundation. Rome IV Diagnostic Criteria for Functional Gastrointestinal 
       Disorders. 4th ed. Raleigh, NC: Rome Foundation; 2016.
    3. Palsson OS, Whitehead WE, van Tilburg MA, Chang L, Chey W, Crowell MD, Keefer L, 
       Lembo AJ, Parkman HP, Rao SS, Sperber A, Spiegel B, Tack J, Vanner S, Walker LS, 
       Whorwell P, Yang M. Rome IV diagnostic questionnaires and tables for investigators 
       and clinicians. Gastroenterology. 2016 May;150(6):1481-1491. 
       doi: 10.1053/j.gastro.2016.02.014.
    """
    
    bowel_symptoms_duration: Literal["yes", "no"] = Field(
        ...,
        description="Bowel symptoms present for ≥3 months with symptom onset ≥6 months prior to diagnosis. "
                   "This temporal criterion ensures chronicity and distinguishes functional disorders from "
                   "acute conditions. Symptoms must have been present for at least 3 months during the 6 months "
                   "preceding diagnosis, though they don't need to be consecutive. The 6-month onset requirement "
                   "ensures the symptoms are not recent developments that might suggest acute pathology requiring "
                   "immediate investigation. Functional bowel disorders are chronic conditions by definition.",
        example="yes"
    )
    
    symptoms_not_organic: Literal["yes", "no"] = Field(
        ...,
        description="Bowel symptoms not attributable to an organic etiology. This requires appropriate "
                   "clinical evaluation to exclude organic causes of bowel symptoms. The extent of evaluation "
                   "depends on patient age, symptom pattern, family history, and presence of alarm symptoms. "
                   "Basic evaluation typically includes history, physical examination, laboratory studies "
                   "(CBC, CMP, inflammatory markers), and consideration of celiac screening. Additional testing "
                   "such as colonoscopy, imaging, or stool studies may be indicated based on clinical presentation. "
                   "Organic causes include IBD, celiac disease, malignancy, infections, and medication effects.",
        example="yes"
    )
    
    exclusion_ibs_criteria: Literal["yes", "no"] = Field(
        ...,
        description="Does not meet Rome IV criteria for Irritable Bowel Syndrome (IBS). IBS requires "
                   "recurrent abdominal pain on average at least 1 day per week in the last 3 months "
                   "associated with 2 or more of: (1) related to defecation, (2) associated with change "
                   "in frequency of stool, (3) associated with change in form (appearance) of stool. "
                   "If patient meets these criteria, they should be diagnosed with IBS rather than "
                   "unspecified functional bowel disorder. IBS is characterized by the predominance of "
                   "abdominal pain as the primary symptom associated with altered bowel habits.",
        example="yes"
    )
    
    exclusion_functional_constipation: Literal["yes", "no"] = Field(
        ...,
        description="Does not meet Rome IV criteria for functional constipation. Functional constipation "
                   "requires 2 or more of the following for ≥3 months: (1) straining ≥25% of defecations, "
                   "(2) lumpy or hard stools ≥25% of defecations, (3) sensation of incomplete evacuation "
                   "≥25% of defecations, (4) sensation of anorectal obstruction ≥25% of defecations, "
                   "(5) manual maneuvers ≥25% of defecations, (6) <3 spontaneous bowel movements per week. "
                   "Additionally, loose stools rarely present without laxatives and insufficient criteria "
                   "for IBS. If these criteria are met, diagnose functional constipation instead.",
        example="yes"
    )
    
    exclusion_functional_diarrhea: Literal["yes", "no"] = Field(
        ...,
        description="Does not meet Rome IV criteria for functional diarrhea. Functional diarrhea requires "
                   "loose or watery stools (Bristol stool scale types 6-7) without predominant abdominal "
                   "pain occurring in ≥75% of bowel movements for ≥3 months with symptom onset ≥6 months "
                   "prior to diagnosis. The absence of abdominal pain distinguishes functional diarrhea "
                   "from IBS with diarrhea (IBS-D). If patient has predominantly loose stools without "
                   "significant pain and meets these criteria, they should be diagnosed with functional "
                   "diarrhea rather than unspecified functional bowel disorder.",
        example="yes"
    )
    
    exclusion_functional_bloating: Literal["yes", "no"] = Field(
        ...,
        description="Does not meet Rome IV criteria for functional abdominal bloating/distension. This "
                   "condition requires recurrent feeling of bloating or observable abdominal distension "
                   "for ≥3 months with symptom onset ≥6 months prior to diagnosis, where bloating/distension "
                   "is the predominant symptom (not pain or altered bowel habits). Bloating may be "
                   "accompanied by other bowel symptoms but should not meet criteria for other functional "
                   "disorders. If bloating is the predominant complaint and meets these criteria, diagnose "
                   "functional abdominal bloating/distension instead.",
        example="yes"
    )
    
    exclusion_gi_bleeding: Literal["yes", "no"] = Field(
        ...,
        description="Exclusion of signs of gastrointestinal bleeding. This includes absence of melena "
                   "(black, tarry stools indicating upper GI bleeding), hematemesis (vomiting blood), "
                   "hematochezia (bright red blood per rectum), or positive fecal occult blood test. "
                   "Any evidence of GI bleeding constitutes an alarm symptom requiring immediate evaluation "
                   "including upper and/or lower endoscopy, complete blood count, and assessment for "
                   "sources of bleeding. GI bleeding suggests organic pathology such as malignancy, "
                   "inflammatory bowel disease, peptic ulcer disease, or vascular malformations and "
                   "excludes functional diagnosis until thoroughly investigated.",
        example="yes"
    )
    
    exclusion_iron_deficiency_anemia: Literal["yes", "no"] = Field(
        ...,
        description="Exclusion of unexplained iron deficiency anemia. Iron deficiency anemia in the "
                   "setting of bowel symptoms may indicate chronic gastrointestinal blood loss, malabsorption, "
                   "or dietary insufficiency requiring investigation. Laboratory assessment should include "
                   "complete blood count, iron studies (serum iron, TIBC, ferritin), and B12/folate levels. "
                   "Unexplained iron deficiency anemia warrants endoscopic evaluation (upper and/or lower "
                   "endoscopy) to exclude malignancy, inflammatory bowel disease, celiac disease, or other "
                   "causes of occult bleeding. Iron deficiency explained by non-GI causes (menstrual losses, "
                   "dietary restrictions) does not exclude functional diagnosis.",
        example="yes"
    )
    
    exclusion_weight_loss: Literal["yes", "no"] = Field(
        ...,
        description="Exclusion of unintentional weight loss. Significant unintentional weight loss "
                   "(typically >10% of body weight over 6 months or >5% over 3 months) in the context "
                   "of bowel symptoms suggests serious underlying pathology. Weight loss may indicate "
                   "malabsorption (celiac disease, inflammatory bowel disease), malignancy (colorectal, "
                   "pancreatic, gastric), hyperthyroidism, or other systemic diseases. Unintentional "
                   "weight loss warrants comprehensive evaluation including imaging studies (CT abdomen/pelvis), "
                   "endoscopy, and laboratory assessment for systemic diseases. Intentional weight loss "
                   "or stable weight does not exclude functional diagnosis.",
        example="yes"
    )
    
    exclusion_abdominal_mass_lymphadenopathy: Literal["yes", "no"] = Field(
        ...,
        description="Exclusion of palpable abdominal mass or lymphadenopathy on physical examination. "
                   "Palpable abdominal masses may indicate malignancy (colorectal, ovarian, pancreatic), "
                   "inflammatory conditions (Crohn's disease), or other organic pathology requiring immediate "
                   "investigation. Lymphadenopathy, particularly in cervical, supraclavicular, axillary, "
                   "or inguinal regions, may suggest systemic disease including malignancy or inflammatory "
                   "conditions. Physical examination should include careful palpation of all lymph node "
                   "regions and thorough abdominal examination. Any palpable abnormalities warrant imaging "
                   "studies and potential biopsy for tissue diagnosis.",
        example="yes"
    )
    
    exclusion_family_history_colon_cancer: Literal["yes", "no"] = Field(
        ...,
        description="Exclusion of family history of colon cancer without appropriate screening. Patients "
                   "with first-degree relatives with colorectal cancer have increased risk and require "
                   "earlier and more frequent screening. Family history of colorectal cancer before age 60 "
                   "or multiple affected relatives warrants colonoscopy screening before age 50 or 10 years "
                   "before the age of the youngest affected relative. If appropriate screening has not been "
                   "performed based on family history, functional diagnosis should be deferred until "
                   "adequate evaluation is completed. This ensures malignancy is not missed in high-risk "
                   "individuals presenting with bowel symptoms.",
        example="yes"
    )
    
    exclusion_age_over_50_without_screening: Literal["yes", "no"] = Field(
        ...,
        description="Exclusion of symptom onset after age 50 without cancer screening. New onset bowel "
                   "symptoms after age 50 raise concern for colorectal malignancy and require colonoscopy "
                   "evaluation before functional diagnosis can be established. Current guidelines recommend "
                   "colorectal cancer screening beginning at age 45-50 for average-risk individuals. "
                   "Patients presenting with new bowel symptoms after age 50 who have not had appropriate "
                   "screening (colonoscopy within 10 years, FIT within 1 year, or other approved screening "
                   "modalities) should undergo evaluation to exclude malignancy before functional diagnosis "
                   "is considered. This alarm symptom has high sensitivity for identifying organic pathology.",
        example="yes"
    )
    
    exclusion_sudden_bowel_habit_change: Literal["yes", "no"] = Field(
        ...,
        description="Exclusion of sudden change in bowel habits. Acute or subacute changes in bowel "
                   "pattern, particularly in older adults, may indicate organic pathology including "
                   "malignancy, inflammatory bowel disease, ischemic colitis, or medication effects. "
                   "Sudden onset of symptoms (days to weeks) differs from the gradual, fluctuating "
                   "course typical of functional disorders. Changes such as new onset constipation, "
                   "diarrhea, narrow stools, or alternating patterns warrant investigation. Functional "
                   "disorders typically have insidious onset with symptoms developing over months to "
                   "years. Sudden changes require evaluation with appropriate imaging, laboratory studies, "
                   "and potentially endoscopy based on clinical presentation.",
        example="yes"
    )
    
    class Config:
        schema_extra = {
            "example": {
                "bowel_symptoms_duration": "yes",
                "symptoms_not_organic": "yes",
                "exclusion_ibs_criteria": "yes",
                "exclusion_functional_constipation": "yes",
                "exclusion_functional_diarrhea": "yes",
                "exclusion_functional_bloating": "yes",
                "exclusion_gi_bleeding": "yes",
                "exclusion_iron_deficiency_anemia": "yes",
                "exclusion_weight_loss": "yes",
                "exclusion_abdominal_mass_lymphadenopathy": "yes",
                "exclusion_family_history_colon_cancer": "yes",
                "exclusion_age_over_50_without_screening": "yes",
                "exclusion_sudden_bowel_habit_change": "yes"
            }
        }


class RomeIvUnspecifiedFunctionalBowelDisorderResponse(BaseModel):
    """
    Response model for Rome IV Diagnostic Criteria for Unspecified Functional Bowel Disorder
    
    The Rome IV criteria for unspecified functional bowel disorder provide a systematic 
    approach to diagnosing patients with functional bowel symptoms that don't meet 
    criteria for more specific disorders. This catch-all diagnosis acknowledges the 
    spectrum nature of functional bowel disorders and provides a framework for managing 
    patients with atypical or mixed symptom patterns.
    
    Diagnostic Outcomes:
    
    POSITIVE DIAGNOSIS ("Criteria Met"):
    - All Rome IV criteria fulfilled including temporal requirements
    - Functional etiology established through appropriate evaluation
    - Does not meet criteria for specific functional bowel disorders
    - All alarm symptoms absent ensuring no organic pathology
    - Confirms unspecified functional bowel disorder diagnosis
    - Indicates need for symptom-directed management approach
    
    NEGATIVE DIAGNOSIS ("Criteria Not Met"):
    - One or more criteria not fulfilled
    - May indicate need for specific functional disorder diagnosis
    - Alarm symptoms present requiring investigation
    - Temporal criteria not met suggesting acute condition
    - Organic etiology suspected or confirmed
    
    Management Implications by Diagnosis:
    
    Positive Diagnosis Management:
    1. Symptom-Directed Therapy:
       - No standardized treatment protocol exists
       - Individualized approach based on predominant symptoms
       - Combination of dietary, pharmacologic, and behavioral interventions
       - Regular monitoring and adjustment of treatment plan
    
    2. Dietary Interventions:
       - Elimination of identified dietary triggers
       - Fiber modification based on symptom pattern
       - Consider low FODMAP diet trial if IBS-like symptoms
       - Probiotics for microbiome modulation
    
    3. Pharmacologic Options:
       - Antispasmodics for cramping and abdominal discomfort
       - Loperamide for diarrhea-predominant symptoms
       - Osmotic laxatives for constipation-predominant symptoms
       - Simethicone for gas and bloating symptoms
    
    4. Behavioral and Psychological Support:
       - Patient education about functional disorder concept
       - Stress management and relaxation techniques
       - Cognitive-behavioral therapy if indicated
       - Regular exercise and lifestyle modifications
    
    5. Follow-up and Monitoring:
       - Regular assessment of treatment response
       - Monitoring for development of alarm symptoms
       - Periodic reassessment as symptoms may evolve
       - Consideration of specialist referral for refractory cases
    
    Negative Diagnosis Evaluation:
    1. Specific Criteria Assessment:
       - If meets IBS criteria: diagnose and treat as IBS
       - If meets functional constipation criteria: specific constipation management
       - If meets functional diarrhea criteria: diarrhea-focused treatment
       - If meets functional bloating criteria: bloating-specific interventions
    
    2. Alarm Symptom Investigation:
       - GI bleeding: urgent endoscopic evaluation and bleeding source identification
       - Iron deficiency anemia: comprehensive GI evaluation including endoscopy
       - Weight loss: imaging studies and malignancy screening
       - Masses/lymphadenopathy: tissue diagnosis and staging evaluation
       - Family history concerns: age-appropriate screening protocols
       - Age >50 without screening: colonoscopy evaluation
       - Sudden bowel changes: comprehensive organic evaluation
    
    3. Temporal Criteria Issues:
       - Symptoms <3 months: follow and reassess over time
       - Recent onset: consider acute conditions requiring immediate evaluation
       - Document symptom evolution and repeat assessment
    
    Treatment Approach Considerations:
    
    Dietary Management:
    - Comprehensive dietary history and trigger identification
    - Gradual fiber modification (increase for constipation, decrease for gas/bloating)
    - Trial of specific dietary interventions (low FODMAP, gluten-free)
    - Small, frequent meals to minimize symptom severity
    - Adequate hydration and regular meal timing
    
    Pharmacologic Interventions:
    - Symptom-targeted therapy rather than broad-spectrum approach
    - Consider combination therapy for multiple symptom types
    - Monitor for medication side effects and interactions
    - Adjust dosing based on symptom severity and response
    - Consider prescription medications for refractory symptoms
    
    Prognosis and Long-term Outlook:
    - Variable response to treatment based on symptom pattern
    - Many patients benefit from multimodal management approach
    - Symptoms may fluctuate with stress and life circumstances
    - Overall good prognosis with appropriate management
    - Quality of life improvement is primary treatment goal
    - Regular follow-up important for optimal outcomes
    
    Special Considerations:
    - Symptoms may evolve to meet criteria for specific functional disorders
    - Functional disorders can coexist with organic conditions
    - Psychological comorbidities common and should be addressed
    - Patient education crucial for treatment adherence and outcomes
    - Avoid excessive testing in absence of alarm symptoms
    
    Reference: Lacy BE, et al. Gastroenterology. 2016;150(6):1393-1407.
    """
    
    result: str = Field(
        ...,
        description="Rome IV diagnostic assessment result: 'Positive' if all criteria met, 'Negative' if criteria not fulfilled",
        example="Positive"
    )
    
    unit: str = Field(
        ...,
        description="Unit of measurement for the diagnostic assessment",
        example="diagnosis"
    )
    
    interpretation: str = Field(
        ...,
        description="Comprehensive clinical interpretation with diagnostic rationale and symptom-directed treatment recommendations",
        example="Patient fulfills Rome IV diagnostic criteria for unspecified functional bowel disorder. This diagnosis applies to bowel symptoms not attributable to organic etiology that do not meet criteria for IBS, functional constipation, functional diarrhea, or functional abdominal bloating/distension disorders. Management should be guided by individual patient symptoms and severity. No specific standardized treatment exists, but symptom-directed therapy may include dietary modifications, probiotics, antispasmodics, or other supportive measures as clinically indicated."
    )
    
    stage: str = Field(
        ...,
        description="Diagnostic stage classification (Criteria Met or Criteria Not Met)",
        example="Criteria Met"
    )
    
    stage_description: str = Field(
        ...,
        description="Brief description of the diagnostic stage",
        example="Meets Rome IV criteria"
    )
    
    class Config:
        schema_extra = {
            "example": {
                "result": "Positive",
                "unit": "diagnosis",
                "interpretation": "Patient fulfills Rome IV diagnostic criteria for unspecified functional bowel disorder. This diagnosis applies to bowel symptoms not attributable to organic etiology that do not meet criteria for IBS, functional constipation, functional diarrhea, or functional abdominal bloating/distension disorders. Management should be guided by individual patient symptoms and severity. No specific standardized treatment exists, but symptom-directed therapy may include dietary modifications, probiotics, antispasmodics, or other supportive measures as clinically indicated.",
                "stage": "Criteria Met",
                "stage_description": "Meets Rome IV criteria"
            }
        }